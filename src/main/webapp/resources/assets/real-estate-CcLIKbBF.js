import{d as c}from"./index-xsOzOzeH.js";var i={};const h=async s=>{try{console.log("ğŸ¢ ì‹¤ì œ ë¶€ë™ì‚° ì •ë³´ API í˜¸ì¶œ:",s);const a=await u(s);if(a.success)return{success:!0,data:{availableDong:a.dong,availableHo:a.ho,availableArea:a.area,buildingInfo:a.buildingInfo,dataSource:"real_trade_api"}};const e=await g(s);if(e.success)return{success:!0,data:{availableDong:e.dong,availableHo:e.ho,availableArea:e.area,buildingInfo:e.buildingInfo,dataSource:"property_portal"}};const r=await p(s);return r.success?{success:!0,data:{availableDong:r.dong,availableHo:r.ho,availableArea:r.area,buildingInfo:r.buildingInfo,dataSource:"cached_data"}}:{success:!1,message:"ì‹¤ì œ ë¶€ë™ì‚° ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",error:"NO_DATA_FOUND"}}catch(a){return console.error("ğŸš¨ ì‹¤ì œ ë¶€ë™ì‚° ì •ë³´ ì¡°íšŒ ì˜¤ë¥˜:",a),{success:!1,message:"ë¶€ë™ì‚° ì •ë³´ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",error:a.message}}},u=async s=>{try{const a=await c.get("/real-estate/apartment-trade",{params:{LAWD_CD:s.regionCode,DEAL_YMD:new Date().getFullYear()+String(new Date().getMonth()+1).padStart(2,"0"),serviceKey:i.VUE_APP_MOLIT_API_KEY}});if(a.data&&a.data.response&&a.data.response.body){const r=(a.data.response.body.items.item||[]).filter(o=>o.ì•„íŒŒíŠ¸&&o.ì•„íŒŒíŠ¸.includes(s.buildingName));if(r.length>0){const o=new Set,d=new Set,l=new Set;return r.forEach(t=>{t.ë™&&o.add(t.ë™.toString()),t.í˜¸ìˆ˜&&d.add(t.í˜¸ìˆ˜.toString()),t.ì „ìš©ë©´ì &&l.add(parseFloat(t.ì „ìš©ë©´ì ).toString())}),{success:!0,dong:Array.from(o).sort((t,n)=>parseInt(t)-parseInt(n)),ho:Array.from(d).sort(),area:Array.from(l).sort((t,n)=>parseFloat(t)-parseFloat(n)),buildingInfo:{name:s.buildingName,address:s.roadAddress,totalUnits:r.length,lastTradeDate:r[0].ê±°ë˜ì¼}}}}return{success:!1}}catch(a){return console.error("êµ­í† êµí†µë¶€ API í˜¸ì¶œ ì˜¤ë¥˜:",a),{success:!1}}},g=async s=>{try{const a=await c.post("/real-estate/portal-search",{buildingName:s.buildingName,address:s.roadAddress,sido:s.sido,sigungu:s.sigungu});if(a.data&&a.data.success){const e=a.data.data;return{success:!0,dong:e.availableDong||[],ho:e.availableHo||[],area:e.availableArea||[],buildingInfo:{name:e.buildingName,address:e.address,buildingType:e.buildingType,totalFloors:e.totalFloors,totalUnits:e.totalUnits,completionYear:e.completionYear}}}return{success:!1}}catch(a){return console.error("ë¶€ë™ì‚° í¬í„¸ API í˜¸ì¶œ ì˜¤ë¥˜:",a),{success:!1}}},p=async s=>{try{const a=await c.get("/real-estate/cached-building",{params:{buildingName:s.buildingName,sido:s.sido,sigungu:s.sigungu}});if(a.data&&a.data.success){const e=a.data.data;return{success:!0,dong:e.dong||[],ho:e.ho||[],area:e.area||[],buildingInfo:e.buildingInfo||{}}}return{success:!1}}catch(a){return console.error("ìºì‹œëœ ë°ì´í„° ì¡°íšŒ ì˜¤ë¥˜:",a),{success:!1}}};export{h as fetchBuildingInfo};
